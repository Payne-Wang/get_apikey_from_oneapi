## 项目简介

本项目是一个使用 R 语言编写的自动化工具，旨在通过与指定 API 交互，实现以下功能：

1. **登录系统**：自动化登录并保存会话 Cookie。
2. **获取用户信息**：使用保存的 Cookie 获取当前用户的详细信息。
3. **获取频道列表**：遍历所有频道并提取频道 ID。
4. **更新频道信息**：对每个频道执行 PUT 请求以更新其信息。

该工具适用于需要批量管理频道信息的场景，简化了手动操作的复杂性，提高了效率。

## 目录

- [项目简介](#项目简介)
- [功能特性](#功能特性)
- [安装与配置](#安装与配置)
  - [前提条件](#前提条件)
  - [安装必要的包](#安装必要的包)
  - [配置项说明](#配置项说明)
- [使用说明](#使用说明)
  - [运行脚本](#运行脚本)
- [文件说明](#文件说明)
- [注意事项](#注意事项)
- [贡献指南](#贡献指南)

## 功能特性

- **自动登录**：通过 API 登录系统并自动保存会话。
- **用户信息获取**：获取并保存当前登录用户的详细信息。
- **频道列表获取**：自动遍历所有频道，提取并保存频道 ID。
- **批量更新**：对所有频道执行批量更新操作，并记录每次操作的响应结果。

## 安装与配置

### 前提条件

- [R 语言](https://www.r-project.org/) 已安装（版本建议 >= 4.0）。
- 具备基本的 R 编程知识。
- 拥有目标系统的 API 访问权限及有效的用户名和密码。

### 安装必要的包

运行以下命令安装 `httr` 和 `jsonlite` 包。如果已经安装，请忽略这一步。

```r
install.packages("httr")
install.packages("jsonlite")
```

加载必要的包：

```r
library(httr)
library(jsonlite)
```

### 配置项说明

在脚本开头部分，有几个需要配置的变量：

- `my_url`：目标系统的基础 URL。例如 `"https://your-api-domain.com"。
- `myroot`：登录用户名。
- `mypwd`：登录密码。
- `COOKIE_FILE`：用于保存会话 Cookie 的文件名，默认为 `"cookies.txt"`。

请根据实际情况修改以下部分：

```r
my_url <- "https://your-api-domain.com"  # 替换为实际的 API 基础 URL
myroot <- "your_username"                # 替换为实际的用户名
mypwd <- "your_password"                 # 替换为实际的密码
COOKIE_FILE <- "cookies.txt"            # 可根据需要修改
```

## 使用说明

确保所有配置项已正确设置后，即可运行脚本执行自动化操作。

### 运行脚本

1. **打开 R 环境**：可以使用 RStudio 或其他支持 R 的 IDE。
2. **加载脚本**：将脚本内容保存为 `script.R` 文件，然后在 R 环境中加载。
   
   ```r
   source("script.R")
   ```

3. **执行脚本**：运行脚本后，系统将依次执行登录、获取用户信息、获取频道列表以及更新频道信息的操作。
4. **查看结果**：
   - 登录状态会在控制台输出。
   - 用户信息会保存在 `response_self.json` 文件中。
   - PUT 请求的响应会保存在 `put_responses_gptproxy.csv` 文件中。
   - 频道列表会打印在控制台，并保存为数据框 `channels_df`。

## 文件说明

- `code.R`：主脚本文件，包含所有自动化操作的代码。
- `cookies.txt`：保存会话 Cookie，用于后续的 API 请求。
- `response_self.json`：保存获取到的用户信息。
- `put_responses_gptproxy.csv`：保存所有 PUT 请求的响应结果。
- `README.md`：项目说明文档。

## 注意事项

- **安全性**：请确保 `cookies.txt`、`response_self.json`、`put_responses_gptproxy.csv` 等文件的安全，避免敏感信息泄露。
- **错误处理**：脚本中已包含基本的错误处理机制，但在实际应用中，建议根据具体需求进一步优化。
- **请求频率**：为避免过于频繁的 API 请求，脚本中设置了 0.5 秒的延迟。根据目标系统的限制，必要时可调整延迟时间。
- **API 变更**：如目标系统的 API 接口发生变化，需及时更新脚本中的请求 URL 和参数。

## 贡献指南

欢迎贡献代码、报告问题或提出改进建议！请按照以下步骤提交贡献：

1. **Fork 本仓库**。
2. **创建新的分支**：`git checkout -b feature/新功能名称`。
3. **提交更改**：`git commit -m "添加新功能说明"`。
4. **推送分支**：`git push origin feature/新功能名称`。
5. **创建 Pull Request**。


---

*感谢您的使用与贡献！*
